# Описание алгоритма установки приложения ASP.NET на локальный хостинг IIS

## Оглавление

1. [Публикация проекта](#Публикация-проекта)
2. [Установка IIS на Windows 10](#Установка-IIS-на-Windows-10)
3. [Хостинг приложения в IIS](#Хостинг-приложения-в-IIS)
- [Возможные ошибки](#Возможные-ошибки)

____

## Публикация проекта

Перед запуском приложения необходимо выгрузить проект из Visual Studio.
Для этого необходимо выполнить следующее:

1. Открыть обозреватель решений и нажать по ASP.NET проекту правой кнопкой мыши
2. В меню нажать кнопку :globe_with_meridians:`Опубликовать`
3. Нажать `Запуск`
4. Выбрать публикацию в папку и выбрать нужынй путь выгрузки
5. Нажать кнопку `Создать профиль` или `Импортировать профиль`
6. Нажать конпку `Опубликовать` и дождаться конца публикации

Готово! По выбранному пути будут находится файлы сервера

## Установка IIS на Windows 10

Теперь необходимо установить IIS на компьютер с Windows 10

1. Перейти: `Панель управления/Программы и компоненты`
2. В боковом меню нажать :warning:`Включение и отключение компонентов Windows`
3. Найти пункт `Службы IIS` и выбрать:
    * :white_square_button:Средства успрваления сайтом
	    + :white_check_mark: Консоль управления IIS
	* :white_square_button:Службы Интернета
	    + :white_square_button: Безопасность
	        - :white_check_mark: Фильтрация запросов
        + :white_square_button: Компоненты разработки приложений
		    - :white_check_mark: .NET Extensibility 4.8
            - :white_check_mark: ASP.NET нужной версии
            - :white_check_mark: Инициализаця приложений
            - :white_check_mark: Расширения ISAPI
            - :white_check_mark: Расширяемость .NET
            - :white_check_mark: Фильтры ISAPI
        + :white_square_button: Общие функции HTTP
            - :white_check_mark: Документ по умолчанию
            - :white_check_mark: Ошибки HTTP
            - :white_check_mark: Просмотр каталога
            - :white_check_mark: Статическое содрежимое
        + :white_square_button: Проверка работоспособности и диагностика
		    - :white_check_mark: Ведение журнала HTTP
        + :white_square_button: Функции повышения быстродействия
		    - :white_check_mark: Сжатие статического содержимого
4. Нажать кнопку :ok: и дождаться установки

Windows выполнит загрузку и установит IIS на компьютер
*Возможно понадобиться перезагрузить устройство*

## Хостинг приложения в IIS

Теперь можно загружать веб-приложение на локальный хостинг
Что надо:

1. Открыть `Панель управления/Администрирование/Диспетчер служб IIS` или <kbd>Win</kbd>+<kbd>S</kbd> и ищем `Диспетчер служб IIS`
2. Найти меню подключений (по умолчанию слева)
3. Открыть папку `Сайты`
4. Выбрать `Default Web Site` для того, чтобы иметь стандартный пул для приложения. Если необходимо, можно создать свой сайт и пул
5. Нажать правой кнопкой мыши по нему и в контекстном меню выбрать `Добавить приложение`
6. Заполнить форму:
    * `Псевдноим` - виртуальный путь для адреса. Можно ввести `myprog` и в результате для обращения будет использоваться адрес `http://localhost/myprog`
    * `Физический путь` - указать путь до [публикации файлов сервера](#Публикация-проекта)
7. Нажать :ok:
8. Перезапустить сайт для хостинга

Готово!

Для просмотра веб-сайта или приложения можно нажать по нему в окне просмотра подключений правой кнопкой мыши и нажать `Управление приложением/Обзор`

____

## Возможные ошибки

При запуске приложения могут возникать различные ошибки :warning:
Этот раздел может помочь решить их :sweat_smile:

### Если нет доступа из локальной сети к приложению

*Убедитесь в правильности подключения приложения и клиента к одной сети

*Поправьте настройки Брандмаура Windows (можно и отключить, но рекомендуется в целях безопасности)

### Если возникает ошибка при хосте сервиса из-за "занятого другим приложением" файла

:exclamation: **Это происходит тогда, когда разные приложения исопльзуют один файл для хостинга** :exclamation:

По умолчанию это: `C:\Windows\System32\drivers\etc\hosts`
В нём можно посмотреть все привязки к адресам

Для того, чтобы решить проблему, **завершите работу** других программ для хостинга (`Appache`, `...`)
*(В частности возникает из-за Денвера)*

### Сервер самостоятельно завершает работу

На этапе разработки я столкнулся с проблемой, что при отсутствии подключений к приложению, сайт отключается самостоятельно спустя 20 минут простаивания
Этот пункт можно исправить, поправив *конфигурацию используемого пула*

1. Открываем страницу `Пулы приложений` в `Диспетчер служб IIS`
2. Находим используемый пул (по умолчанию `DefaultAppPool` для IIS 7) и выбираем его
3. В меню с правой стороны экрана нажать `Дополнительные настройки`
4. Найти секцию **Модель процесса** и в ней будет элемент `Тайм-аут простоя (в минутах)`
5. Изменить значение на нужное
